---
phase: 04-tech-debt-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - scripts/generate-blog-posts.js
autonomous: true

must_haves:
  truths:
    - "TDD pattern detection identifies test/feat/refactor commit sequences"
    - "Outdated stub comments removed"
  artifacts:
    - path: "scripts/generate-blog-posts.js"
      provides: "Enhanced blog generation with TDD pattern detection"
      contains: "TDD commit pattern detection logic"
---

<objective>
Clean up tech debt from Phase 3: add TDD pattern detection to blog script and remove outdated stub comments.

Purpose: Enhance blog content with TDD-specific insights and clean up misleading comments.

Output: Updated generate-blog-posts.js with TDD pattern detection and no outdated comments.
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Add TDD pattern detection to blog script</name>
  <files>
    scripts/generate-blog-posts.js
  </files>
  <action>
Add TDD pattern detection to the `synthesizeAgenticPost` function:

1. In the iteration patterns section, add logic to identify TDD commit sequences:
   - Look for commits with messages matching: test(...), feat(...), refactor(...)
   - Identify sequences where test commit precedes feat commit
   - Count TDD cycles (test → feat → optional refactor)

2. Add a helper function `detectTddPatterns(commits)`:
   ```javascript
   function detectTddPatterns(commits) {
     const tddCycles = [];
     for (let i = 0; i < commits.length - 1; i++) {
       const current = commits[i];
       const next = commits[i + 1];
       if (current.match(/^test\(/i) && next.match(/^feat\(/i)) {
         tddCycles.push({ test: current, feat: next });
       }
     }
     return {
       cycles: tddCycles.length,
       sequences: tddCycles
     };
   }
   ```

3. Include TDD pattern insights in the iteration_patterns section of the agentic post:
   - "X TDD cycles detected (test → feat sequences)"
   - List example sequences if any found

4. Handle case where no TDD patterns found: "No explicit TDD patterns detected in commit history"
  </action>
  <verify>
```bash
grep -q "detectTddPatterns\|tddCycles\|test.*feat" scripts/generate-blog-posts.js && echo "✓ TDD detection added"
```
  </verify>
  <done>
TDD pattern detection function added and integrated into synthesizeAgenticPost.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove outdated stub comments</name>
  <files>
    scripts/generate-blog-posts.js
  </files>
  <action>
Remove or update the outdated comments on lines 36 and 39 that say "stub for now" when the functions are actually implemented.

Find comments like:
- "// stub for now"
- "// Stub:"
- Similar outdated placeholders

Either remove them entirely or update to reflect actual implementation status.
  </action>
  <verify>
```bash
! grep -qi "stub for now\|stub:" scripts/generate-blog-posts.js && echo "✓ Stub comments removed"
```
  </verify>
  <done>
Outdated stub comments removed or updated.
  </done>
</task>

</tasks>

<verification>
- TDD pattern detection function exists
- synthesizeAgenticPost includes TDD insights
- No outdated stub comments remain
</verification>

<success_criteria>
- TDD commit sequences detected and reported in blog posts
- Script has no misleading "stub" comments
</success_criteria>

<output>
After completion, create `.planning/phases/04-tech-debt-cleanup/04-01-SUMMARY.md`
</output>
