---
phase: 03-milestone-blog-posts
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/templates/blog-post-architecture.md
  - get-shit-done/templates/blog-post-agentic.md
  - scripts/generate-blog-posts.js
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "Blog post templates exist for architecture and agentic practices posts"
    - "Blog generation script exists with retry logic"
    - "docs/blog/ directory creation logic exists"
    - "docs/blog/ is gitignored"
  artifacts:
    - path: "get-shit-done/templates/blog-post-architecture.md"
      provides: "Template structure for architecture/project learnings posts"
      contains: "Template with placeholders for milestone content"
    - path: "get-shit-done/templates/blog-post-agentic.md"
      provides: "Template structure for agentic coding practices posts"
      contains: "Template with placeholders for agentic learnings"
    - path: "scripts/generate-blog-posts.js"
      provides: "Blog generation script with artifact collection and retry logic"
      min_lines: 100
      exports: ["generateBlogPosts"]
  key_links:
    - from: "scripts/generate-blog-posts.js"
      to: "get-shit-done/templates/blog-post-architecture.md"
      via: "fs.readFileSync template path"
      pattern: "readFileSync.*blog-post-architecture"
    - from: "scripts/generate-blog-posts.js"
      to: "get-shit-done/templates/blog-post-agentic.md"
      via: "fs.readFileSync template path"
      pattern: "readFileSync.*blog-post-agentic"
    - from: "scripts/generate-blog-posts.js"
      to: "docs/blog/"
      via: "fs.writeFileSync output path"
      pattern: "writeFileSync.*docs/blog"
---

<objective>
Create blog post templates and generation script infrastructure for milestone blog post automation.

Purpose: Establish the foundation for automated blog post generation from milestone artifacts. Templates define structure and voice; script provides artifact collection, content synthesis, and retry logic.

Output: Two markdown templates (architecture and agentic practices), Node.js script with retry logic, docs/blog/ directory creation, and gitignore entry.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-milestone-blog-posts/03-CONTEXT.md
@.planning/phases/03-milestone-blog-posts/03-RESEARCH.md
@get-shit-done/workflows/complete-milestone.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create blog post templates</name>
  <files>
    get-shit-done/templates/blog-post-architecture.md
    get-shit-done/templates/blog-post-agentic.md
  </files>
  <action>
Create two markdown templates for blog post generation:

**blog-post-architecture.md:**
- Template for architecture/project learnings posts
- Include placeholders for: title, date, milestone version, introduction, key learnings sections, code snippets with importance annotations, conclusion
- Structure: Title → Meta (date, milestone) → Introduction → Learnings (3-5 sections) → Code Examples → Conclusion
- Voice: Technical depth, clear explanations, lessons learned
- Use placeholders like {{TITLE}}, {{DATE}}, {{MILESTONE_VERSION}}, {{INTRO}}, {{LEARNINGS}}, {{CODE_SNIPPETS}}, {{CONCLUSION}}
- Include guidance comments for content synthesis (what to extract from which artifacts)

**blog-post-agentic.md:**
- Template for agentic coding practices posts
- Include placeholders for: title, date, milestone version, introduction, iteration patterns, failure/recovery stories, timing data, worktree patterns, prompt evolution
- Structure: Title → Meta → Introduction → Agentic Patterns → Iterations & Failures → Timing Insights → Conclusion
- Voice: Process-focused, meta-learning about agentic workflows
- Use placeholders like {{TITLE}}, {{DATE}}, {{MILESTONE_VERSION}}, {{INTRO}}, {{ITERATION_PATTERNS}}, {{FAILURES}}, {{TIMING}}, {{WORKTREE_PATTERNS}}, {{CONCLUSION}}
- Include guidance comments for extracting subagent data, iteration counts, timing from artifacts

Both templates should be flexible enough to adapt to milestone complexity (some milestones have more learnings than others). Include markdown formatting examples (code blocks, lists, emphasis) in guidance comments.
  </action>
  <verify>
Templates exist:
```bash
test -f get-shit-done/templates/blog-post-architecture.md && test -f get-shit-done/templates/blog-post-agentic.md && echo "✓ Templates created"
```
Both templates contain placeholder patterns ({{PLACEHOLDER}}) and structure sections.
  </verify>
  <done>
Both template files exist with placeholder structure and guidance comments for content synthesis.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create blog generation script with retry logic</name>
  <files>
    scripts/generate-blog-posts.js
  </files>
  <action>
Create Node.js script `scripts/generate-blog-posts.js` that:

**Core structure:**
- Use native Node.js modules: `fs`, `path`, `child_process` (for git commands)
- Export main function: `generateBlogPosts(milestoneVersion, milestoneName)`
- Accept milestone version (e.g., "1.0") and name (e.g., "MVP") as parameters

**Directory setup:**
- Create `docs/blog/` directory if it doesn't exist (use `fs.mkdirSync` with `recursive: true`)
- Check if `docs/blog/` is in `.gitignore`, add if missing (read .gitignore, check for pattern, append if absent)

**Template loading:**
- Read both templates using `fs.readFileSync`
- Store template content as strings for later placeholder replacement

**Retry logic:**
- Implement `generateWithRetry()` wrapper function
- Max retries: 3
- Exponential backoff: 2s, 4s, 8s delays between retries
- Use `setTimeout` wrapped in Promise for delays
- Catch errors, log retry attempts, return success/failure status
- After max retries, log warning but return success (don't throw - non-blocking)

**Script structure (stubs for now):**
- `collectArtifacts(milestoneVersion)` - returns artifact data object (stub: return empty object)
- `synthesizeArchitecturePost(artifacts, template)` - returns markdown string (stub: return template with placeholders)
- `synthesizeAgenticPost(artifacts, template)` - returns markdown string (stub: return template with placeholders)
- `writeBlogPosts(architecturePost, agenticPost, milestoneVersion, milestoneName)` - writes files to docs/blog/ with slug filenames

**Filename generation:**
- Architecture post: `v{milestoneVersion}-{slug}.md` where slug is derived from milestone name (lowercase, hyphens)
- Agentic post: `v{milestoneVersion}-agentic-practices.md`
- Use `path.join` for cross-platform paths

**Error handling:**
- Wrap all file operations in try/catch
- Log errors with context (which step failed)
- Return status object: `{ success: boolean, error?: string, files?: string[] }`

Script should be executable and handle missing directories gracefully.
  </action>
  <verify>
Script exists and is syntactically valid:
```bash
node -c scripts/generate-blog-posts.js && echo "✓ Script syntax valid"
```
Script exports `generateBlogPosts` function:
```bash
node -e "const mod = require('./scripts/generate-blog-posts.js'); console.log(typeof mod.generateBlogPosts === 'function' ? '✓ Function exported' : '✗ Missing export')"
```
Retry logic structure exists (check for retry function, exponential backoff pattern).
  </verify>
  <done>
Script file exists with retry wrapper, template loading, directory creation, and stub functions for artifact collection and content synthesis. Script handles errors gracefully and returns status object.
  </done>
</task>

</tasks>

<verification>
- Both templates exist with placeholder structure
- Script exists and exports generateBlogPosts function
- Script includes retry logic with exponential backoff
- Script creates docs/blog/ directory
- Script ensures docs/blog/ is gitignored
- All file operations use proper error handling
</verification>

<success_criteria>
- Templates provide structure for both post types with clear placeholders
- Script infrastructure ready for artifact collection and synthesis (stubs in place)
- Retry logic prevents blocking milestone completion
- Directory and gitignore setup complete
</success_criteria>

<output>
After completion, create `.planning/phases/03-milestone-blog-posts/03-01-SUMMARY.md`
</output>
